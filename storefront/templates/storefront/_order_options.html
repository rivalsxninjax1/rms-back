<div class="card" style="padding:12px;margin-top:16px">
  <h4>Order Options</h4>
  <div class="row" style="gap:10px;margin:10px 0">
    {% with sel=sel_override|default:cart.delivery_option %}
    <button class="btn {% if sel == 'DINE_IN' %}primary{% endif %}" onclick="loadTableModal()">Dine-in</button>
    <form style="display:inline" action="{% url 'storefront:cart_option' %}" method="post" class="js-ajax">
      {% csrf_token %}
      <input type="hidden" name="order_type" value="TAKEAWAY"/>
      <button class="btn {% if sel == 'PICKUP' %}primary{% endif %}">Takeaway</button>
    </form>
    <form style="display:inline" action="{% url 'storefront:cart_option' %}" method="post" class="js-ajax">
      {% csrf_token %}
      <input type="hidden" name="order_type" value="UBEREATS"/>
      <button class="btn {% if sel == 'DELIVERY' and cart.metadata.provider == 'UBEREATS' %}primary{% endif %}">UberEats</button>
    </form>
    <form style="display:inline" action="{% url 'storefront:cart_option' %}" method="post" class="js-ajax">
      {% csrf_token %}
      <input type="hidden" name="order_type" value="DOORDASH"/>
      <button class="btn {% if sel == 'DELIVERY' and cart.metadata.provider == 'DOORDASH' %}primary{% endif %}">DoorDash</button>
    </form>
    {% endwith %}
  </div>

  {% if cart.delivery_option == 'DINE_IN' and sel_table_ids %}
    <div class="muted">Selected tables:
      {% for t in tables %}
        {% if t.id in sel_table_ids %}
          <span>{{ t.table_number }}</span>{% if not forloop.last %}, {% endif %}
        {% endif %}
      {% endfor %}
      <button class="btn" style="margin-left:8px" onclick="loadTableModal()">Change</button>
    </div>
  {% endif %}
</div>

<!-- Coupon entry just below Order Options -->
<div class="card" style="padding:12px;margin-top:12px">
  <h4>Have a Coupon?</h4>
  <form class="row js-ajax" action="{% url 'storefront:cart_coupon' %}" method="post" style="gap:8px;align-items:center;margin-top:8px">
    {% csrf_token %}
    <input type="text" name="code" placeholder="Enter coupon code" style="flex:1;min-width:200px"/>
    <button class="btn">Apply</button>
  </form>
  {% if cart.applied_coupon_code %}
    <div class="muted" style="margin-top:8px">
      Applied coupon: <strong>{{ cart.applied_coupon_code }}</strong>
      {% if cart.coupon_discount and cart.coupon_discount|floatformat != '0.00' %}
        &nbsp;·&nbsp; Discount: <strong>₹ {{ cart.coupon_discount }}</strong>
      {% endif %}
    </div>
  {% endif %}
</div>
