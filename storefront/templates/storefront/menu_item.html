{% extends "storefront/base.html" %}
{% load static %}
{% block title %}{% if item %}{{ item.name }}{% else %}Menu Item{% endif %} ‚Äì {{ SITE_NAME|default:"RMS" }}{% endblock %}

{% block content %}
  <div class="container" style="max-width:960px;margin:24px auto;">
    <a href="{% url 'storefront:menu' %}" style="text-decoration:none;color:#007bff;font-weight:500;">‚¨Ö Back to Menu</a>

    {% if item %}
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:30px;margin-top:20px;">
      <div>
        <div style="aspect-ratio:4/3;background:#f7f7f7;display:flex;align-items:center;justify-content:center;border-radius:12px;overflow:hidden;box-shadow:0 4px 12px rgba(0,0,0,0.1);">
          {% if item.image %}
            <img src="{{ item.image.url }}" alt="{{ item.name }}" style="width:100%;height:100%;object-fit:cover;">
          {% else %}
            <img src="{% static 'storefront/img/placeholder.svg' %}" alt="Menu Item" style="width:60%;opacity:.6;">
          {% endif %}
        </div>
      </div>

      <div>
        <h1 style="margin-top:0;margin-bottom:8px;">{{ item.name }}</h1>
        <div class="muted" style="color:#666;margin-bottom:16px;">{{ item.description }}</div>

        <div style="font-size:22px;font-weight:700;margin-bottom:16px;">
          {{ DEFAULT_CURRENCY|default:"NPR" }} {{ item.price }}
        </div>

        <div style="margin-bottom:16px;">
          <span class="muted">Category:</span>
          <strong>{{ item.category.name }}</strong>
        </div>

        {% if item.is_spicy %}
        <div style="margin-bottom:12px;">
          <span style="background:#ef4444;color:white;padding:4px 12px;border-radius:20px;font-size:14px;">üå∂Ô∏è Spicy</span>
        </div>
        {% endif %}

        {% if item.is_vegetarian %}
        <div style="margin-bottom:20px;">
          <span style="background:#10b981;color:white;padding:4px 12px;border-radius:20px;font-size:14px;">
            üå± Vegetarian
          </span>
        </div>
        {% endif %}

        <div style="margin-top:24px;display:flex;gap:12px;">
          <!-- FIX: align data attributes with cart.js expectations -->
          <button
            type="button"
            class="btn btn-primary add-to-cart"
            data-add-to-cart
            data-menu-id="{{ item.id }}"
            data-name="{{ item.name|escape }}"
            data-price="{{ item.price }}"
            data-image="{% if item.image %}{{ item.image.url }}{% endif %}"
            style="background:#007bff;color:white;border:none;padding:10px 16px;border-radius:8px;font-size:16px;font-weight:500;cursor:pointer;transition:all 0.2s;"
          >
            Add to Cart
          </button>
          <a href="{% url 'storefront:cart' %}" 
             class="btn btn-secondary" 
             style="background:#f8f9fa;color:#333;border:1px solid #ddd;padding:10px 16px;border-radius:8px;text-decoration:none;font-size:16px;font-weight:500;transition:all 0.2s;">
            View Cart
          </a>
        </div>
      </div>
    </div>
    {% else %}
      <p>Item not found.</p>
    {% endif %}
  </div>

  <style>
    .muted { color:#666; }
    .btn-primary:hover {
      background: #0056b3 !important;
      transform: translateY(-1px);
    }
    
    .btn-secondary:hover {
      background: #e9ecef !important;
      transform: translateY(-1px);
    }
  </style>

  <script>
    window.DEFAULT_CURRENCY = "{{ DEFAULT_CURRENCY|default:'NPR' }}";
  </script>
{% endblock %}
