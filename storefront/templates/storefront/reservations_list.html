{% extends "storefront/base.html" %}
{% block title %}Reservations{% endblock %}
{% block content %}
<main class="container">
  <h2>My Reservations</h2>
  {% if need_login %}
    <p class="muted">Please log in to view your reservations.</p>
    <script>window.dispatchEvent(new Event('auth:required'));</script>
  {% else %}
    {% if reservations %}
      <div class="card" style="padding:12px">
        {% for r in reservations %}
          <div style="border-bottom:1px solid #24283a;padding:12px 0">
            <div class="row" style="justify-content:space-between; align-items:baseline">
              <div>
                <div style="font-weight:600">Table {{ r.table.table_number }} · {{ r.location.name }}</div>
                <div class="muted">Party {{ r.party_size }}{% if r.guest_name %} · {{ r.guest_name }}{% endif %}</div>
              </div>
              <div style="text-align:right">
                <div>{{ r.start_time|date:"Y-m-d H:i" }} → {{ r.end_time|date:"H:i" }}</div>
                <div class="muted" style="font-size:12px">Booked on {{ r.created_at|date:"Y-m-d H:i" }} ({{ r.created_at|timesince }} ago)</div>
              </div>
            </div>
            <div class="row" style="justify-content:space-between;margin-top:6px">
              <div>
                <span style="display:inline-block; padding:2px 8px; border-radius:999px; background:#1e2233; border:1px solid #2a2d3d; font-size:12px">Status: {{ r.status|title }}</span>
                {% if r.confirmation_number %}
                  <span class="muted" style="margin-left:8px; font-size:12px">#{{ r.confirmation_number }}</span>
                {% endif %}
              </div>
              {% if r.deposit_amount and r.deposit_amount|floatformat:2 != '0.00' %}
                <div class="muted" style="font-size:12px">Deposit: ${{ r.deposit_amount|floatformat:2 }} · {{ r.deposit_paid|yesno:"Paid,Unpaid" }}</div>
              {% endif %}
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="muted">No reservations.</p>
    {% endif %}
  {% endif %}
</main>
{% endblock %}
